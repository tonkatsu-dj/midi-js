let midiNotes = [
  {
    pitch: 42,
    velocity: 100,
    start: 0,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 0,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 0,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 0,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 0,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 0,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 468.75,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 468.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 468.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 468.75,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 468.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 468.75,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 703.125,
    duration: 117.1875,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 703.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 703.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 703.125,
    duration: 117.1875,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 703.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 703.125,
    duration: 117.1875,
  },
  {
    pitch: 39,
    velocity: 100,
    start: 820.3125,
    duration: 234.375,
  },
  {
    pitch: 51,
    velocity: 100,
    start: 820.3125,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 820.3125,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 820.3125,
    duration: 234.375,
  },
  {
    pitch: 66,
    velocity: 100,
    start: 820.3125,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 820.3125,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 1875,
    duration: 234.375,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 1875,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 1875,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 1875,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 1875,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 1875,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 2343.75,
    duration: 234.375,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 2343.75,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 2343.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 2343.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 2343.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 2343.75,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 2578.125,
    duration: 117.1875,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 2578.125,
    duration: 117.1875,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 2578.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 2578.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 2578.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 2578.125,
    duration: 117.1875,
  },
  {
    pitch: 41,
    velocity: 100,
    start: 2695.3125,
    duration: 234.375,
  },
  {
    pitch: 53,
    velocity: 100,
    start: 2695.3125,
    duration: 234.375,
  },
  {
    pitch: 60,
    velocity: 100,
    start: 2695.3125,
    duration: 234.375,
  },
  {
    pitch: 63,
    velocity: 100,
    start: 2695.3125,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 2695.3125,
    duration: 234.375,
  },
  {
    pitch: 72,
    velocity: 100,
    start: 2695.3125,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 3750,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 3750,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 3750,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 3750,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 3750,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 3750,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 4218.75,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 4218.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 4218.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 4218.75,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 4218.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 4218.75,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 4453.125,
    duration: 117.1875,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 4453.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 4453.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 4453.125,
    duration: 117.1875,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 4453.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 4453.125,
    duration: 117.1875,
  },
  {
    pitch: 39,
    velocity: 100,
    start: 4570.3125,
    duration: 234.375,
  },
  {
    pitch: 51,
    velocity: 100,
    start: 4570.3125,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 4570.3125,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 4570.3125,
    duration: 234.375,
  },
  {
    pitch: 66,
    velocity: 100,
    start: 4570.3125,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 4570.3125,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 5625,
    duration: 234.375,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 5625,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 5625,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 5625,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 5625,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 5625,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 6093.75,
    duration: 234.375,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 6093.75,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 6093.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 6093.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 6093.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 6093.75,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 6328.125,
    duration: 117.1875,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 6328.125,
    duration: 117.1875,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 6328.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 6328.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 6328.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 6328.125,
    duration: 117.1875,
  },
  {
    pitch: 41,
    velocity: 100,
    start: 6445.3125,
    duration: 234.375,
  },
  {
    pitch: 53,
    velocity: 100,
    start: 6445.3125,
    duration: 234.375,
  },
  {
    pitch: 60,
    velocity: 100,
    start: 6445.3125,
    duration: 234.375,
  },
  {
    pitch: 63,
    velocity: 100,
    start: 6445.3125,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 6445.3125,
    duration: 234.375,
  },
  {
    pitch: 72,
    velocity: 100,
    start: 6445.3125,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 7500,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 7500,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 7500,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 7500,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 7500,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 7500,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 7968.75,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 7968.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 7968.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 7968.75,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 7968.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 7968.75,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 8203.125,
    duration: 117.1875,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 8203.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 8203.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 8203.125,
    duration: 117.1875,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 8203.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 8203.125,
    duration: 117.1875,
  },
  {
    pitch: 39,
    velocity: 100,
    start: 8320.3125,
    duration: 234.375,
  },
  {
    pitch: 51,
    velocity: 100,
    start: 8320.3125,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 8320.3125,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 8320.3125,
    duration: 234.375,
  },
  {
    pitch: 66,
    velocity: 100,
    start: 8320.3125,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 8320.3125,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 9375,
    duration: 234.375,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 9375,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 9375,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 9375,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 9375,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 9375,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 77,
    velocity: 100,
    start: 9843.75,
    duration: 234.375,
  },
  {
    pitch: 34,
    velocity: 100,
    start: 10078.125,
    duration: 117.1875,
  },
  {
    pitch: 46,
    velocity: 100,
    start: 10078.125,
    duration: 117.1875,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 10078.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 10078.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 10078.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 10078.125,
    duration: 117.1875,
  },
  {
    pitch: 41,
    velocity: 100,
    start: 10195.3125,
    duration: 234.375,
  },
  {
    pitch: 53,
    velocity: 100,
    start: 10195.3125,
    duration: 234.375,
  },
  {
    pitch: 60,
    velocity: 100,
    start: 10195.3125,
    duration: 234.375,
  },
  {
    pitch: 63,
    velocity: 100,
    start: 10195.3125,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 10195.3125,
    duration: 234.375,
  },
  {
    pitch: 72,
    velocity: 100,
    start: 10195.3125,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 11250,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 11250,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 11250,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 11250,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 11250,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 11250,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 11718.75,
    duration: 234.375,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 11718.75,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 11718.75,
    duration: 234.375,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 11718.75,
    duration: 234.375,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 11718.75,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 11718.75,
    duration: 234.375,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 11953.125,
    duration: 117.1875,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 11953.125,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 11953.125,
    duration: 117.1875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 11953.125,
    duration: 117.1875,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 11953.125,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 11953.125,
    duration: 117.1875,
  },
  {
    pitch: 39,
    velocity: 100,
    start: 12070.3125,
    duration: 234.375,
  },
  {
    pitch: 51,
    velocity: 100,
    start: 12070.3125,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 12070.3125,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 12070.3125,
    duration: 234.375,
  },
  {
    pitch: 66,
    velocity: 100,
    start: 12070.3125,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 12070.3125,
    duration: 234.375,
  },
  {
    pitch: 39,
    velocity: 100,
    start: 12656.25,
    duration: 234.375,
  },
  {
    pitch: 51,
    velocity: 100,
    start: 12656.25,
    duration: 234.375,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 12656.25,
    duration: 234.375,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 12656.25,
    duration: 234.375,
  },
  {
    pitch: 66,
    velocity: 100,
    start: 12656.25,
    duration: 234.375,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 12656.25,
    duration: 234.375,
  },
  {
    pitch: 39,
    velocity: 100,
    start: 12890.625,
    duration: 117.1875,
  },
  {
    pitch: 51,
    velocity: 100,
    start: 12890.625,
    duration: 117.1875,
  },
  {
    pitch: 58,
    velocity: 100,
    start: 12890.625,
    duration: 117.1875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 12890.625,
    duration: 117.1875,
  },
  {
    pitch: 66,
    velocity: 100,
    start: 12890.625,
    duration: 117.1875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 12890.625,
    duration: 117.1875,
  },
  {
    pitch: 42,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 54,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 61,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 65,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 77,
    velocity: 100,
    start: 13007.8125,
    duration: 1054.6875,
  },
  {
    pitch: 44,
    velocity: 100,
    start: 14062.5,
    duration: 937.5,
  },
  {
    pitch: 56,
    velocity: 100,
    start: 14062.5,
    duration: 937.5,
  },
  {
    pitch: 60,
    velocity: 100,
    start: 14062.5,
    duration: 937.5,
  },
  {
    pitch: 63,
    velocity: 100,
    start: 14062.5,
    duration: 937.5,
  },
  {
    pitch: 68,
    velocity: 100,
    start: 14062.5,
    duration: 937.5,
  },
  {
    pitch: 70,
    velocity: 100,
    start: 14062.5,
    duration: 937.5,
  }
];

let noteIndex = 0;
let startTime = null;

function ProcessMIDI() {
    if (startTime === null) {
        startTime = Date.now();
    }

    let elapsedTime = Date.now() - startTime;

    while (noteIndex < midiNotes.length) {
        let note = midiNotes[noteIndex];
        
        if (elapsedTime >= note.start) {
            let noteOn = new NoteOn();
            noteOn.pitch = note.pitch;
            noteOn.velocity = note.velocity;
            Trace(`Playing note ${note.pitch} with velocity ${note.velocity} for ${note.duration} ms`);
            noteOn.send();

            let noteOff = new NoteOff(noteOn);
            noteOff.sendAfterMilliseconds(note.duration);

            noteIndex++;
        } else {
            break;
        }
    }
}

function Reset() {
    noteIndex = 0;
    startTime = null;
}

Reset();
